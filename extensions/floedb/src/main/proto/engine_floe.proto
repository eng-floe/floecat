// Copyright 2026 Yellowbrick Data, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

syntax = "proto2";
package ai.floedb.floecat.extensions.floedb.proto;

option java_multiple_files = true;
option java_package = "ai.floedb.floecat.extensions.floedb.proto";

import "query/engine_specific.proto";

message FloeNamespaceSpecific {
  optional int32 oid = 100;
  optional string nspname = 101;
  
  optional int32 nspowner = 1;
  repeated string nspacl = 2;
}

message FloeRelationSpecific {
  // pg_class identity
  optional int32 oid = 100;
  optional string relname = 101;

  // namespace
  optional int32 relnamespace = 1;
  optional int32 relowner = 2;

  // relation kind: r, v, m, i, S, c, f, p
  optional string relkind = 3;

  // storage / stats
  optional int32 relpages = 4;
  optional int32 reltuples = 5;
  optional int32 reltoastrelid = 6;
  optional int32 reltoastidxid = 7;

  // flags
  optional bool relhasindex = 8;
  optional bool relisshared = 9;
  optional bool relpersistence = 10;
  optional bool relispartition = 11;

  // ACL
  repeated string relacl = 12;
}

message FloeColumnSpecific {
  optional int32 attrelid = 1;
  optional string attname = 2;
  optional int32 atttypid = 3;
  optional int32 atttypmod = 4;
  optional int32 attnum = 5;
  optional int32 attlen = 6;
  optional bool attnotnull = 7;
  optional bool attisdropped = 8;
  optional bool attbyval = 9;
  optional string attalign = 10;
  optional string attstorage = 11;
  optional int32 attndims = 12;
  optional int32 attcollation = 13;
}

message FloeFunctionSpecific {
  optional int32  oid = 100;
  optional string proname = 101;

  optional int32  pronamespace = 1;
  optional int32  proowner = 2;
  optional int32  prolang = 3;
  optional float  procost = 4;
  optional float  prorows = 5;
  optional int32  provariadic = 6;
  optional string protransform = 7;
  optional bool   proisagg = 8;
  optional bool   proiswindow = 9;
  optional bool   prosecdef = 10;
  optional bool   proleakproof = 11;
  optional bool   proisstrict = 12;
  optional bool   proretset = 13;
  optional string provolatile = 14;
  optional int32  pronargs = 15;
  optional int32  pronargdefaults = 16;

  optional int32  prorettype = 17;
  repeated int32  proargtypes = 18;
  repeated int32  proallargtypes = 19;
  repeated string proargmodes = 20;
  repeated string proargnames = 21;
  optional string proargdefaults = 22;

  repeated int32 protrftypes = 23;

  optional string prosrc = 24;
  optional string probin = 25;
  repeated string proconfig = 26;
  repeated string proacl = 27;
  optional bool   prosp = 28;
  optional bool   proybudf = 29;
  optional int32  prorettypmod = 30;
  optional string procreated = 31;
  optional bool   proisbatch = 32;
  optional int32  proybcost = 33;
}

message FloeCastSpecific {
  optional int32 castsource = 1;
  optional int32 casttarget = 2;
  optional int32 castfunc = 3;
  optional string castcontext = 4;
  optional string castmethod = 5;
}

message FloeTypeSpecific {
  optional int32 oid = 100;
  optional string typname = 101;

  optional int32 typnamespace = 1;
  optional int32 typowner = 2;
  optional int32 typlen = 3;
  optional bool  typbyval = 4;
  optional string typtype = 5;
  optional string typcategory = 6;
  optional bool  typispreferred = 7;
  optional bool  typisdefined = 8;
  optional string typdelim = 9;

  optional int32 typrelid = 10;
  optional int32 typelem = 11;
  optional int32 typarray = 12;

  optional string typinput = 13;
  optional string typoutput = 14;
  optional string typreceive = 15;
  optional string typsend = 16;
  optional string typmodin = 17;
  optional string typmodout = 18;
  optional string typanalyze = 19;

  optional string typalign = 20;
  optional string typstorage = 21;
  optional bool   typnotnull = 22;

  optional int32  typbasetype = 23;
  optional int32  typtypmod = 24;
  optional int32  typndims = 25;
  optional int32  typcollation = 26;

  optional string typdefaultbin = 27;
  optional string typdefault = 28;

  repeated string typacl = 29;
}

message FloeOperatorSpecific {
  optional int32 oid = 100;
  optional string oprname = 101;

  optional int32 oprnamespace = 1;
  optional int32 oprowner = 2;

  optional string oprkind = 3;
  optional bool   oprcanmerge = 4;
  optional bool   oprcanhash = 5;

  optional int32  oprleft = 6;
  optional int32  oprright = 7;
  optional int32  oprresult = 8;
  optional int32  oprcom = 9;
  optional int32  oprnegate = 10;
  optional int32  oprcode = 11;
  optional int32  oprrest = 12;
  optional int32  oprjoin = 13;
}

message FloeAggregateSpecific {
  optional int32 aggfnoid = 1;
  optional string aggkind = 2;
  optional int32 aggnumdirectargs = 3;

  optional int32 aggtransfn = 4;
  optional int32 aggfinalfn = 5;
  optional int32 aggmtransfn = 6;
  optional int32 aggminvtransfn = 7;
  optional int32 aggmfinalfn = 8;

  optional bool  aggfinalextra = 9;
  optional bool  aggmfinalextra = 10;

  optional int32 aggsortop = 11;

  optional int32 aggtranstype = 12;
  optional int32 aggtransspace = 13;

  optional int32 aggmtranstype = 14;
  optional int32 aggmtransspace = 15;

  optional string agginitval = 16;
  optional string aggminitval = 17;
}

message FloeCollationSpecific {
  optional int32 oid = 1;
  optional string collname = 2;
  optional int32 collnamespace = 3;
  optional int32 collencoding = 4;
  optional string collcollate = 5;
  optional string collctype = 6;
}

extend ai.floedb.floecat.query.EngineSpecific {
  optional FloeFunctionSpecific floe_function = 1;
  optional FloeOperatorSpecific floe_operator = 2;
  optional FloeCastSpecific floe_cast = 3;
  optional FloeTypeSpecific floe_type = 4;
  optional FloeAggregateSpecific floe_aggregate = 5;
  optional FloeCollationSpecific floe_collation = 6;
  optional FloeNamespaceSpecific floe_namespace = 7;
  optional FloeRelationSpecific floe_relation = 8;
}
